<html>
<head>

<link rel="stylesheet" type="text/css" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css">
<link rel="stylesheet" type="text/css" href="http://cdn.jsdelivr.net/bxslider/4.1/jquery.bxslider.css">

<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
<script src="http://cdn.jsdelivr.net/bxslider/4.1/jquery.bxslider.min.js"></script>


<style type="text/css">
  .canvas_wrapper {
    /*float: left;*/
    text-align: center;
    padding: 0.5em;
    /*border: 1px solid black;*/
  }
  
  .canvas_controls {
    margin: 0.5em;
  }
  
  .ui-slider {
    margin-bottom: 0.5em;
  }
  
  .wrapper {
    width: 420px;
    height: 900px;
  }
</style>

<script src="barnsley.js"></script>
<script src="tree.js"></script>
<script src="mandelbrot.js"></script>
<script src="maze.js"></script>

<script type="text/javascript">
function init_canvas(id, bgcolor, fgcolor) {
  var canvas = document.getElementById(id);
  var context = canvas.getContext('2d');
  context.fillStyle = bgcolor;
  context.fillRect(0, 0, $(canvas).width(), $(canvas).height());
  context.fillStyle = fgcolor;
  context.strokeStyle = fgcolor;
  
  return context;
}


$(document).ready(function(){
  draw_barnsley_fern(init_canvas('barnsley', '#FFFFFF', '#009900'), {
    scale: 30,
    xoffset: 3,
    yoffset: 10,
  });
 
  function three_branch_tree(branch_angle) {
    var tree_context = init_canvas('tree', '#FFFFFF', '#663300');
    draw_three_branch_tree(tree_context,
      {
        initial_point: {x: 160, y: 290},
        trunk_length: 260,
        max_depth: 8,
        start_angle: -90,
        branch_angle: branch_angle
      });
  }

  three_branch_tree(parseInt($('#angle').text()));
  
  var slider = $('#slider').slider({
    min: 0,
    max: 180,
    value: $('#angle').text(),
    slide: function(event, ui) {
      $('#angle').text(ui.value);
      three_branch_tree(parseInt($('#angle').text()));
  }});

  draw_mandelbrot(init_canvas('mandelbrot', '#000000', '#FFFFFF'),
      {color_depth: 16777215, max_iteration: 100});

  var maze_context = init_canvas('maze', '#000000', '#E8EDE8');
  draw_maze(maze_context, {cell_size: maze_context.canvas.width / 16, cell_color: '#E8EDE8', current_cell_color: '#FF0000'});
  
  $('.bxslider').bxSlider({onSlideAfter: function(elem, prevIndex, curIndex){
    var canvas = $(elem["0"]).find("canvas");
    if (!canvas.attr("loaded")) {
      // TODO: do the canvas drawing here
      canvas.attr("loaded", true);
      var canvas_id = canvas.attr("id");
      console.log(canvas_id);
    }
  }});
});
</script>
</head>
<body>
<div class="wrapper">
  <ul class="bxslider">
    <li>
      <div class="canvas_wrapper">
        <canvas id="barnsley" width="220" height="320"></canvas>
      </div>
    </li>
    <li>
      <div class="canvas_wrapper">
        <canvas id="tree" width="320" height="320"></canvas>
        <div class="canvas_controls">
          <div id="slider" ></div>
          <span> Branch Angle: <span id="angle">30</span>&deg;</span>
        </div>
      </div>
    </li>
    <li>
      <div class="canvas_wrapper">
        <canvas id="mandelbrot" width="320" height="320"></canvas>
      </div>
    </li>
    <li>
      <div class="canvas_wrapper">
        <canvas id="maze" width="320" height="320"></canvas>
      </div>
    </li>
  </ul>
</div>
</body>
</html>
